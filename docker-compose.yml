services:
  sanitizer:
    build: .
    container_name: moca_sanitizer
    network_mode: none # ğŸ›¡ï¸ COMPLETE ISOLATION
    volumes:
      - ./input:/app/input:ro # Read-only input
      - ./output:/app/output:rw # Write-only output
      # Mount the script for easier development/testing without rebuilding
      - ./sanitizer.py:/app/sanitizer.py:ro
    deploy:
      resources:
        limits:
          memory: 2G
          pids: 128
    # S-Grade Security Hardening ğŸ”’
    security_opt:
      - no-new-privileges:true
    cap_drop:
      - ALL
    read_only: true
    tmpfs:
      - /tmp
    # Keep container alive for debugging if needed, or just let it run the CMD
    # command: python sanitizer.py
